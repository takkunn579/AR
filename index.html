<html>
  <head>
    <meta charset="utf-8">
    <title>A-Frame Snapshot Example</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <!-- html2canvasã‚’åˆ©ç”¨ã—ã¦HTMLå…¨ä½“ã‚’ã‚¹ã‚¯ã‚·ãƒ§ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
      body, html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #000;
      }
      #snapshotBtn {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 20px;
        font-size: 16px;
        background: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        z-index: 10;
      }
    </style>
  </head>
  <body>
    <!-- A-Frameã‚·ãƒ¼ãƒ³ -->
    <a-scene id="scene" embedded>
      <a-assets>
        <img id="bg" src="https://cdn.aframe.io/a-painter/images/sky.jpg">
      </a-assets>
      <a-sky src="#bg"></a-sky>
      <a-box position="0 1.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere position="2 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>
      <a-entity camera look-controls></a-entity>
    </a-scene>

    <!-- æ’®å½±ãƒœã‚¿ãƒ³ -->
    <button id="snapshotBtn">ğŸ“· æ’®å½±ï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>

    <script>
      document.getElementById("snapshotBtn").addEventListener("click", async () => {
        try {
          const scene = document.getElementById("scene");

          // html2canvasã§A-Frameã‚·ãƒ¼ãƒ³å…¨ä½“ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£
          const canvas = await html2canvas(scene, {
            useCORS: true,
            backgroundColor: null // é€æ˜ã‚„èƒŒæ™¯ã‚’æ­£ã—ãå–ã‚‹
          });

          // DataURLåŒ–
          const dataURL = canvas.toDataURL("image/png");

          // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ä½œæˆ
          const link = document.createElement("a");
          link.href = dataURL;
          link.download = "snapshot.png";
          link.click();

        } catch (err) {
          console.error("æ’®å½±ã‚¨ãƒ©ãƒ¼:", err);
          alert("ã‚¹ã‚¯ã‚·ãƒ§ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");
        }
      });
    </script>
  </body>
</html>
